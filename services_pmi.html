<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ISM Services Industry Heatmap</title>
    <meta name="deployment-version" content="auto-updated-2025-12-22-1938">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
            background-color: #f8f9fa;
            color: #333;
        }

        h1,
        h2 {
            color: #2c3e50;
            text-align: center;
        }

        h2 {
            margin-top: 60px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            display: inline-block;
        }

        table {
            border-collapse: separate;
            border-spacing: 0;
            width: 100%;
            margin: 20px auto;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            background-color: white;
            font-size: 0.9em;
            border-radius: 8px;
        }

        th,
        td {
            padding: 12px 15px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }

        th {
            background-color: #e67e22;
            /* Orange for Services */
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 20;
            box-shadow: 0 2px 2px -1px rgba(0, 0, 0, 0.2);
            border-bottom: none;
        }

        .industry-col {
            text-align: left;
            font-weight: 600;
            width: 260px;
            position: sticky;
            left: 0;
            z-index: 15;
            border-right: 1px solid #ddd;
            background-color: #fff;
        }

        th.industry-col {
            z-index: 30;
            background-color: #d35400;
            /* Darker orange */
            border-right: 1px solid #a04000;
        }

        /* Zebra Stripping */
        tbody tr:nth-child(even) .industry-col {
            background-color: #f9f9f9;
        }

        tbody tr:hover .industry-col {
            background-color: #e2e6ea !important;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin: 30px auto;
            font-size: 0.9em;
            background: white;
            padding: 15px;
            border-radius: 50px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            width: fit-content;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
        }

        .color-box {
            width: 18px;
            height: 18px;
            border-radius: 4px;
            border: none;
        }

        .back-nav {
            margin-bottom: 20px;
        }

        .back-nav a {
            text-decoration: none;
            color: #64748b;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            font-family: 'Segoe UI', sans-serif;
            font-size: 0.95rem;
            transition: color 0.2s ease;
        }

        .back-nav a:hover {
            color: #1e293b;
            text-decoration: underline;
        }

        .summary-box {
            background-color: #fff;
            border-left: 5px solid #e67e22;
            padding: 20px;
            margin: 15px auto 50px auto;
            max-width: 95%;
            border-radius: 0 4px 4px 0;
            color: #444;
            line-height: 1.6;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body>

    <div class="back-nav">
        <a href="index.html">← Back to Financial Dashboard</a>
    </div>

    <h1>ISM Services Industry Trends (Nov '24 - Nov '25)</h1>

    <div style="text-align: center; margin-bottom: 20px;">
        <a href="services_comments.html"
            style="color: #d35400; text-decoration: none; font-size: 1.1em; font-weight: bold;">View Respondent Comments
            &rarr;</a>
    </div>

    <div class="legend">
        <div class="legend-item">
            <div class="color-box" style="background-color: #2ecc71;"></div> Strong Growth
        </div>
        <div class="legend-item">
            <div class="color-box" style="background-color: #ffff99;"></div> Stable (0)
        </div>
        <div class="legend-item">
            <div class="color-box" style="background-color: #e74c3c;"></div> Strong Contraction
        </div>
    </div>

    <table id="heatmapTable">
        <thead>
            <tr id="headerRow">
                <th class="industry-col">Industry</th>
                <!-- Months will be populated by JS -->
            </tr>
        </thead>
        <tbody id="tableBody">
            <!-- Data rows will be populated by JS -->
        </tbody>
    </table>


    <div id="main-summary-box" class="summary-box">
        <h3>Key Insights (Nov 2025)</h3>
        <ul>
            <li><strong>Resilient Expansion:</strong> The Services PMI® registered 52.1% in November, marking the 5th
                consecutive month of expansion. 14 industries reported growth, indicating broad-based sector resilience.
            </li>
            <li><strong>Sector Leaders:</strong> Accommodation & Food Services and Arts, Entertainment & Recreation
                continue to lead, driven by strong consumer demand and seasonal activity.</li>
            <li><strong>Employment Stability:</strong> Employment remains in expansion territory (51.5%), albeit slower
                than October, with industries actively filling positions despite some hiring freezes.</li>
            <li><strong>Price Pressures:</strong> The Prices Index remains elevated at 58.2%, reflecting persistent
                input cost challenges across the service economy.</li>
        </ul>
    </div>

    <div class="table-container">
        <table id="heatmapTable">
            <thead>
                <tr id="headerRow">
                    <th>Industry</th>
                    <!-- Months will be populated by JS -->
                </tr>
            </thead>
            <tbody id="tableBody">
                <!-- Data rows will be populated by JS -->
            </tbody>
        </table>
    </div>

    <div id="new-orders-summary-box" class="summary-box" style="margin-top: 40px;">
        <h3>New Orders Key Insights (Nov 2025)</h3>
        <ul>
            <li><strong>Demand Growth:</strong> The New Orders Index registered 53.7%, expanding for the 5th consecutive
                month. 13 industries reported growth in new orders.</li>
            <li><strong>Top Performers:</strong> Public Administration and Arts/Entertainment saw the strongest demand
                inflow, fueled by government activity and holiday season preparations.</li>
            <li><strong>Contraction Pockets:</strong> Real Estate and Mining faced headwinds, reporting contraction in
                new orders due to rate sensitivity and global market fluctuations.</li>
        </ul>
    </div>

    <div class="table-container">
        <table id="rankTable">
            <thead>
                <tr id="rankHeaderRow">
                    <th>New Orders Rank</th>
                    <!-- Months will be populated by JS -->
                </tr>
            </thead>
            <tbody id="rankTableBody">
                <!-- Rank rows will be populated by JS -->
            </tbody>
        </table>
    </div>

    <div class="footer">
        <p>Source: Institute for Supply Management (ISM) - Services Report on Business</p>
        <p>Last Updated: <span id="last-updated-date">Dec 22, 2025</span></p>
    </div>

    <script>
        // Data for the last 13 months (Nov 2025 Back to Nov 2024)
        const months = ["Nov 2025", "Oct 2025", "Sep 2025", "Aug 2025", "Jul 2025", "Jun 2025", "May 2025", "Apr 2025", "Mar 2025", "Feb 2025", "Jan 2025", "Dec 2024", "Nov 2024"];

        // Heatmap Data (Derived from Net Growth/Contraction Ranks)
        // Scores: Positive for Growth (Rank 1 = Lowest Growth, Rank N = Highest Growth)
        //         Negative for Contraction (Rank -1 = Lowest Decline, Rank -N = Highest Decline)
        //         0 for No Change or Not Listed
        const servicesData = {
            "Retail Trade": [4, 7, 4, -2, -2, 6, -7, 7, 7, -2, 6, 7, 6],
            "Arts, Entertainment & Recreation": [13, 11, -2, -2, 7, 7, 9, 6, -2, 0, 0, 8, 13],
            "Accommodation & Food Services": [14, 7, 4, 1, 11, 10, 10, 11, 12, 4, 13, 3, 14],
            "Wholesale Trade": [11, 6, 10, 10, 8, 7, -1, 10, 8, 12, 11, 2, 11],
            "Health Care & Social Assistance": [12, 10, 9, 7, 7, 2, 2, 5, 2, 7, 9, 6, 12],
            "Educational Services": [-3, -2, 9, -3, 5, 2, 5, 2, 3, -1, 8, -5, -1],
            "Public Administration": [9, 8, 2, 1, 2, 6, 8, -2, 6, 1, 2, 4, 9],
            "Agriculture, Forestry, Fishing & Hunting": [10, -2, 12, 8, 6, 4, -5, -6, 5, 10, 14, -4, 10],
            "Finance & Insurance": [8, 12, 8, 11, -3, 8, -4, -4, 9, 13, 10, 9, 8],
            "Information": [4, -2, 5, 3, 6, 2, 3, 3, 0, 2, 5, -2, 4],
            "Professional, Scientific & Technical Services": [3, -2, -2, 2, 3, -2, 1, -5, -1, 3, -1, -3, 3],
            "Utilities": [1, 5, 1, 7, 4, 1, 6, 1, 4, 11, 1, 1, 1],
            "Other Services": [0, 0, -3, 13, -3, 1, -8, 0, 0, 14, -3, 0, 0],
            "Transportation & Warehousing": [5, 9, 7, 4, 6, 9, -2, 4, 11, 5, 7, 5, 5],
            "Management of Companies & Support Services": [7, -1, 2, -2, 1, -6, -6, -3, -3, -3, 3, -1, 7],
            "Mining": [-4, 0, 11, 9, 6, 9, 7, 9, 0, 9, 12, 0, -3],
            "Real Estate, Rental & Leasing": [-2, -4, -2, 6, 5, 4, 4, 8, 10, 8, -2, -6, -2],
            "Construction": [2, 0, 4, 3, -6, 3, -3, -1, 1, 6, 4, 0, 2]
        };

        const headerRow = document.getElementById('headerRow');
        const tableBody = document.getElementById('tableBody');

        // Populate Headers
        months.forEach(month => {
            const th = document.createElement('th');
            th.textContent = month;
            headerRow.appendChild(th);
        });

        function getColor(score) {
            if (score === 0) return '#ffff99';
            if (score > 0) {
                const intensity = Math.min(score / 12, 1);
                return `rgba(46, 204, 113, ${0.2 + (0.8 * intensity)})`;
            }
            if (score < 0) {
                const absScore = Math.abs(score);
                const intensity = Math.min(absScore / 5, 1);
                return `rgba(231, 76, 60, ${0.2 + (0.8 * intensity)})`;
            }
        }

        // Populate Rows
        Object.keys(servicesData).sort().forEach(industry => {
            const tr = document.createElement('tr');

            const nameTd = document.createElement('td');
            nameTd.className = 'industry-col';
            nameTd.textContent = industry;
            tr.appendChild(nameTd);

            servicesData[industry].forEach(score => {
                const td = document.createElement('td');
                // Format: +N, -N, or 0
                td.textContent = score > 0 ? `+${score}` : (score === 0 ? '0' : score);

                // Styling
                if (score === 0) {
                    td.style.backgroundColor = getColor(0); // #ffff99
                    td.style.color = '#333';
                } else {
                    td.style.backgroundColor = getColor(score);
                    if (Math.abs(score) > 8) td.style.color = 'white';
                }

                tr.appendChild(td);
            });
            tableBody.appendChild(tr);
        });



    </script>
    <script>
        // --- New Orders Rank Data ---
        const ranklists = {
            "Nov 2025": {
                growth: ["Public Administration", "Arts, Entertainment & Recreation", "Retail Trade", "Other Services", "Wholesale Trade", "Health Care & Social Assistance", "Educational Services", "Transportation & Warehousing", "Finance & Insurance", "Professional, Scientific & Technical Services", "Utilities", "Information"],
                decline: ["Real Estate, Rental & Leasing", "Management of Companies & Support Services", "Construction", "Accommodation & Food Services"]
            },
            "Oct 2025": {
                growth: ["Accommodation & Food Services", "Retail Trade", "Wholesale Trade", "Real Estate, Rental & Leasing", "Health Care & Social Assistance", "Utilities", "Transportation & Warehousing", "Agriculture, Forestry, Fishing & Hunting", "Information", "Professional, Scientific & Technical Services", "Educational Services"],
                decline: ["Arts, Entertainment & Recreation", "Management of Companies & Support Services", "Finance & Insurance", "Public Administration", "Construction", "Other Services"]
            },
            "Sep 2025": {
                growth: ["Accommodation & Food Services", "Other Services", "Health Care & Social Assistance", "Public Administration", "Information", "Wholesale Trade", "Educational Services", "Finance & Insurance", "Utilities"],
                decline: ["Real Estate, Rental & Leasing", "Construction", "Agriculture, Forestry, Fishing & Hunting", "Retail Trade", "Management of Companies & Support Services", "Professional, Scientific & Technical Services"]
            },
            "Aug 2025": {
                growth: ["Wholesale Trade", "Educational Services", "Arts, Entertainment & Recreation", "Information", "Transportation & Warehousing", "Retail Trade", "Utilities", "Management of Companies & Support Services", "Health Care & Social Assistance", "Finance & Insurance", "Public Administration", "Professional, Scientific & Technical Services", "Real Estate, Rental & Leasing"],
                decline: ["Construction", "Accommodation & Food Services"]
            },
            "Jul 2025": {
                growth: ["Wholesale Trade", "Transportation & Warehousing", "Finance & Insurance", "Public Administration", "Other Services", "Management of Companies & Support Services", "Utilities"],
                decline: ["Accommodation & Food Services", "Construction", "Arts, Entertainment & Recreation", "Agriculture, Forestry, Fishing & Hunting", "Educational Services", "Real Estate, Rental & Leasing", "Health Care & Social Assistance"]
            },
            "Jun 2025": {
                growth: ["Other Services", "Finance & Insurance", "Professional, Scientific & Technical Services", "Transportation & Warehousing", "Wholesale Trade", "Utilities", "Public Administration", "Educational Services"],
                decline: ["Agriculture, Forestry, Fishing & Hunting", "Mining", "Real Estate, Rental & Leasing", "Construction"]
            },
            "May 2025": {
                growth: ["Accommodation & Food Services", "Arts, Entertainment & Recreation", "Public Administration", "Educational Services", "Utilities", "Information"],
                decline: ["Mining", "Management of Companies & Support Services", "Real Estate, Rental & Leasing", "Other Services", "Wholesale Trade", "Retail Trade", "Construction"]
            },
            "Apr 2025": {
                growth: ["Accommodation & Food Services", "Wholesale Trade", "Transportation & Warehousing", "Educational Services", "Real Estate, Rental & Leasing", "Information", "Retail Trade", "Health Care & Social Assistance"],
                decline: ["Professional, Scientific & Technical Services", "Management of Companies & Support Services", "Construction", "Finance & Insurance", "Public Administration"]
            },
            "Mar 2025": {
                growth: ["Transportation & Warehousing", "Wholesale Trade", "Utilities", "Accommodation & Food Services", "Finance & Insurance", "Public Administration", "Retail Trade", "Information", "Health Care & Social Assistance"],
                decline: ["Professional, Scientific & Technical Services", "Real Estate, Rental & Leasing", "Management of Companies & Support Services", "Educational Services"]
            },
            "Feb 2025": {
                growth: ["Mining", "Construction", "Finance & Insurance", "Agriculture, Forestry, Fishing & Hunting", "Other Services", "Health Care & Social Assistance", "Wholesale Trade", "Utilities", "Public Administration", "Transportation & Warehousing", "Professional, Scientific & Technical Services"],
                decline: ["Management of Companies & Support Services", "Accommodation & Food Services", "Retail Trade", "Educational Services"]
            },
            "Jan 2025": {
                growth: ["Accommodation & Food Services", "Agriculture, Forestry, Fishing & Hunting", "Educational Services", "Finance & Insurance", "Wholesale Trade", "Transportation & Warehousing", "Health Care & Social Assistance", "Public Administration", "Construction", "Retail Trade"],
                decline: ["Real Estate, Rental & Leasing", "Other Services", "Professional, Scientific & Technical Services", "Information", "Management of Companies & Support Services"]
            },
            "Dec 2024": {
                growth: ["Arts, Entertainment & Recreation", "Finance & Insurance", "Transportation & Warehousing", "Retail Trade", "Public Administration", "Health Care & Social Assistance", "Utilities"],
                decline: ["Real Estate, Rental & Leasing", "Educational Services", "Construction", "Information", "Professional, Scientific & Technical Services"]
            },
            "Nov 2024": {
                growth: ["Arts, Entertainment & Recreation", "Accommodation & Food Services", "Management of Companies & Support Services", "Public Administration", "Information", "Wholesale Trade", "Retail Trade", "Agriculture, Forestry, Fishing & Hunting", "Health Care & Social Assistance", "Professional, Scientific & Technical Services", "Finance & Insurance", "Transportation & Warehousing", "Utilities"],
                decline: ["Mining", "Real Estate, Rental & Leasing", "Educational Services"]
            }
        };

        // Normalize Name Function (Map variations to standard keys if needed)
        function normalizeName(name) {
            const map = {
                "Nonmetallic Minerals": "Nonmetallic Mineral Products",
                "Power & Energy": "Utilities"
            };
            return map[name] || name;
        }

        // Build Rank Data Table
        const rankTableBody = document.getElementById('rankTableBody');
        const rankHeaderRow = document.getElementById('rankHeaderRow');

        // 1. Populate Headers (Months) - reusing `months` array logic
        // We currently only have 3 months of data for this table.
        // Let's filter `months` to only show those we have data for, OR show all with placeholders.
        // For consistency with heatmap, let's show all but leave empty for missing data.

        months.forEach(month => {
            const th = document.createElement('th');
            th.textContent = month;
            rankHeaderRow.appendChild(th);
        });

        // 2. Iterate Industries and Months to Calculate Scores
        const industries = Object.keys(servicesData).sort();

        industries.forEach(industry => {
            const tr = document.createElement('tr');

            // Industry Name
            const nameTd = document.createElement('td');
            nameTd.className = 'industry-col';
            nameTd.textContent = industry;
            tr.appendChild(nameTd);

            // Loop through months
            months.forEach(month => {
                const list = ranklists[month];
                let score = 0;

                if (list) {
                    // Check Growth
                    const growthIdx = list.growth.findIndex(n => normalizeName(n) === industry);
                    if (growthIdx !== -1) {
                        score = list.growth.length - growthIdx;
                    }

                    // Check Decline
                    if (score === 0) { // Only check decline if not in growth
                        const declineIdx = list.decline.findIndex(n => normalizeName(n) === industry);
                        if (declineIdx !== -1) {
                            score = -(list.decline.length - declineIdx);
                        }
                    }
                }

                const td = document.createElement('td');
                // Only show number if score is non-zero (i.e., we have data)
                // For missing months, show '-'
                if (!list) {
                    td.textContent = '-';
                    td.style.backgroundColor = 'white';
                } else {
                    td.textContent = score > 0 ? `+${score}` : (score === 0 ? '0' : score);
                    td.style.backgroundColor = getColor(score); // Reusing heatmap color scale
                    if (Math.abs(score) > 8) td.style.color = 'white';
                    // Dim zeros if present (meaning 'No Change' or omitted)
                    if (score === 0) {
                        td.style.backgroundColor = getColor(0); // #ffff99
                        td.style.color = '#333';
                        td.textContent = '0';
                    }
                }

                tr.appendChild(td);
            });
            rankTableBody.appendChild(tr);
        });
    </script>
</body>

</html>