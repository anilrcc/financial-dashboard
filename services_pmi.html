<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ISM Services Industry Heatmap</title>
    <meta name="deployment-version" content="auto-updated-2025-12-22-1938">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
            background-color: #f8f9fa;
            color: #333;
        }

        h1,
        h2 {
            color: #2c3e50;
            text-align: center;
        }

        h2 {
            margin-top: 60px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            display: inline-block;
        }

        table {
            border-collapse: separate;
            border-spacing: 0;
            width: 100%;
            margin: 20px auto;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            background-color: white;
            font-size: 0.9em;
            border-radius: 8px;
        }

        th,
        td {
            padding: 12px 15px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }

        th {
            background-color: #e67e22;
            /* Orange for Services */
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 20;
            box-shadow: 0 2px 2px -1px rgba(0, 0, 0, 0.2);
            border-bottom: none;
        }

        .industry-col {
            text-align: left;
            font-weight: 600;
            width: 260px;
            position: sticky;
            left: 0;
            z-index: 15;
            border-right: 1px solid #ddd;
            background-color: #fff;
        }

        th.industry-col {
            z-index: 30;
            background-color: #d35400;
            /* Darker orange */
            border-right: 1px solid #a04000;
        }

        /* Zebra Stripping */
        tbody tr:nth-child(even) .industry-col {
            background-color: #f9f9f9;
        }

        tbody tr:hover .industry-col {
            background-color: #e2e6ea !important;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin: 30px auto;
            font-size: 0.9em;
            background: white;
            padding: 15px;
            border-radius: 50px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            width: fit-content;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
        }

        .color-box {
            width: 18px;
            height: 18px;
            border-radius: 4px;
            border: none;
        }

        .back-nav {
            margin-bottom: 20px;
        }

        .back-nav a {
            text-decoration: none;
            color: #64748b;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            font-family: 'Segoe UI', sans-serif;
            font-size: 0.95rem;
            transition: color 0.2s ease;
        }

        .back-nav a:hover {
            color: #1e293b;
            text-decoration: underline;
        }

        .summary-box {
            background-color: #fff;
            border-left: 5px solid #e67e22;
            padding: 20px;
            margin: 15px auto 50px auto;
            max-width: 95%;
            border-radius: 0 4px 4px 0;
            color: #444;
            line-height: 1.6;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body>

    <div class="back-nav">
        <a href="index.html">← Back to Financial Dashboard</a>
    </div>

    <h1>ISM Services Industry Trends (Nov '24 - Nov '25)</h1>

    <div style="text-align: center; margin-bottom: 20px;">
        <a href="services_comments.html"
            style="color: #d35400; text-decoration: none; font-size: 1.1em; font-weight: bold;">View Respondent Comments
            &rarr;</a>
    </div>

    <div class="legend">
        <div class="legend-item">
            <div class="color-box" style="background-color: #2ecc71;"></div> Strong Growth
        </div>
        <div class="legend-item">
            <div class="color-box" style="background-color: #ffff99;"></div> Stable (0)
        </div>
        <div class="legend-item">
            <div class="color-box" style="background-color: #e74c3c;"></div> Strong Contraction
        </div>
    </div>

    <div class="table-container">
        <table id="heatmapTable">
            <thead>
                <tr id="headerRow">
                    <th class="industry-col">Industry</th>
                    <!-- Months will be populated by JS -->
                </tr>
            </thead>
            <tbody id="tableBody">
                <!-- Data rows will be populated by JS -->
            </tbody>
        </table>
    </div>

    <div id="main-summary-box" class="summary-box">
        <h3>Key Insights (Nov 2025)</h3>
        <ul>
            <li><strong>Resilient Expansion:</strong> The Services PMI® registered 52.1% in November, marking the 5th
                consecutive month of expansion. 14 industries reported growth, indicating broad-based sector resilience.
            </li>
            <li><strong>Sector Leaders:</strong> Accommodation & Food Services and Arts, Entertainment & Recreation
                continue to lead, driven by strong consumer demand and seasonal activity.</li>
            <li><strong>Employment Stability:</strong> Employment remains in expansion territory (51.5%), albeit slower
                than October, with industries actively filling positions despite some hiring freezes.</li>
            <li><strong>Price Pressures:</strong> The Prices Index remains elevated at 58.2%, reflecting persistent
                input cost challenges across the service economy.</li>
        </ul>
        <h4 style="margin-top: 25px; color: #d35400;">Trend Analysis</h4>
        <p><strong>Top 3 Industries with Longest Periods of Growth:</strong></p>
        <ul style="margin: 5px 0 15px 20px;">
            <li><strong>Accommodation & Food Services</strong> (13 months)</li>
            <li><strong>Health Care & Social Assistance</strong> (13 months)</li>
            <li><strong>Utilities</strong> (13 months)</li>
        </ul>

        <p><strong>Top 3 Industries with Longest Periods of Contraction:</strong></p>
        <ul style="margin: 5px 0 15px 20px;">
            <li><strong>Management of Companies & Support Services</strong> (5 months)</li>
            <li><strong>Real Estate, Rental & Leasing</strong> (3 months)</li>
            <li><strong>Retail Trade</strong> (2 months)</li>
        </ul>

        <p><strong>Industries Moving from Contraction to Growth (Latest Report):</strong> <strong>Agriculture, Forestry,
                Fishing & Hunting</strong>, <strong>Information</strong>, <strong>Professional, Scientific & Technical
                Services</strong>, <strong>Management of Companies & Support Services</strong> have shifted from
            negative to positive territory, signaling renewed momentum in these sectors.</p>
    </div>

    <h2>New Orders Rank</h2>

    <div class="table-container">
        <table id="rankTable">
            <thead>
                <tr id="rankHeaderRow">
                    <th class="industry-col">Industry</th>
                    <!-- Months will be populated by JS -->
                </tr>
            </thead>
            <tbody id="rankTableBody">
                <!-- Rank rows will be populated by JS -->
            </tbody>
        </table>
    </div>

    <div id="new-orders-summary-box" class="summary-box" style="margin-top: 40px;">
        <h3>New Orders Key Insights (Nov 2025)</h3>
        <ul>
            <li><strong>Demand Growth:</strong> The New Orders Index registered 53.7%, expanding for the 5th consecutive
                month. 13 industries reported growth in new orders.</li>
            <li><strong>Top Performers:</strong> Public Administration and Arts/Entertainment saw the strongest demand
                inflow, fueled by government activity and holiday season preparations.</li>
            <li><strong>Contraction Pockets:</strong> Real Estate and Mining faced headwinds, reporting contraction in
                new orders due to rate sensitivity and global market fluctuations.</li>
        </ul>
        <h4 style="margin-top: 25px; color: #d35400;">Trend Analysis</h4>
        <p><strong>Top 3 Industries with Longest Periods of New Orders Growth:</strong></p>
        <ul style="margin: 5px 0 15px 20px;">
            <li><strong>Utilities</strong> (7 months)</li>
            <li><strong>Transportation & Warehousing</strong> (6 months)</li>
            <li><strong>Health Care & Social Assistance</strong> (6 months)</li>
        </ul>

        <p><strong>Top 3 Industries with Longest Periods of New Orders Contraction:</strong></p>
        <ul style="margin: 5px 0 15px 20px;">
            <li><strong>Construction</strong> (8 months)</li>
            <li><strong>Management of Companies & Support Services</strong> (5 months)</li>
            <li><strong>Real Estate, Rental & Leasing</strong> (3 months)</li>
        </ul>

        <p><strong>Industries Moving from Contraction to Growth (Latest Report):</strong> <strong>Other
                Services</strong>, <strong>Public Administration</strong>, <strong>Finance & Insurance</strong>,
            <strong>Arts, Entertainment & Recreation</strong> have all shifted to positive new order growth, indicating
            renewed demand momentum.
        </p>

        <p><strong>Industries Moving from Growth to Contraction (Latest Report):</strong> <strong>Real Estate, Rental &
                Leasing</strong>, <strong>Accommodation & Food Services</strong> have reversed from growth to
            contraction, suggesting potential seasonal adjustments or sector-specific headwinds.</p>
    </div>

    <div class="footer">
        <p>Source: Institute for Supply Management (ISM) - Services Report on Business</p>
        <p>Last Updated: <span id="last-updated-date">Dec 22, 2025</span></p>
    </div>

    <script>
        // Data for the last 13 months (Nov 2024 to Nov 2025, oldest to newest)
        const months = ["Nov 2024", "Dec 2024", "Jan 2025", "Feb 2025", "Mar 2025", "Apr 2025", "May 2025", "Jun 2025", "Jul 2025", "Aug 2025", "Sep 2025", "Oct 2025", "Nov 2025"];

        // Heatmap Data (Derived from Net Growth/Contraction Ranks)
        // Scores: Positive for Growth (Rank 1 = Lowest Growth, Rank N = Highest Growth)
        //         Negative for Contraction (Rank -1 = Lowest Decline, Rank -N = Highest Decline)
        //         0 for No Change or Not Listed
        const servicesData = {
            "Retail Trade": [6, 7, 6, -2, 7, 7, -7, 6, -2, -2, 4, 7, 4],
            "Arts, Entertainment & Recreation": [13, 8, 0, 0, -2, 6, 9, 7, 7, -2, -2, 11, 13],
            "Accommodation & Food Services": [14, 3, 13, 4, 12, 11, 10, 10, 11, 1, 4, 7, 14],
            "Wholesale Trade": [11, 2, 11, 12, 8, 10, -1, 7, 8, 10, 10, 6, 11],
            "Health Care & Social Assistance": [12, 6, 9, 7, 2, 5, 2, 2, 7, 7, 9, 10, 12],
            "Educational Services": [-1, -5, 8, -1, 3, 2, 5, 2, 5, -3, 9, -2, -3],
            "Public Administration": [9, 4, 2, 1, 6, -2, 8, 6, 2, 1, 2, 8, 9],
            "Agriculture, Forestry, Fishing & Hunting": [10, -4, 14, 10, 5, -6, -5, 4, 6, 8, 12, -2, 10],
            "Finance & Insurance": [8, 9, 10, 13, 9, -4, -4, 8, -3, 11, 8, 12, 8],
            "Information": [4, -2, 5, 2, 0, 3, 3, 2, 6, 3, 5, -2, 4],
            "Professional, Scientific & Technical Services": [3, -3, -1, 3, -1, -5, 1, -2, 3, 2, -2, -2, 3],
            "Utilities": [1, 1, 1, 11, 4, 1, 6, 1, 4, 7, 1, 5, 1],
            "Other Services": [0, 0, -3, 14, 0, 0, -8, 1, -3, 13, -3, 0, 0],
            "Transportation & Warehousing": [5, 5, 7, 5, 11, 4, -2, 9, 6, 4, 7, 9, 5],
            "Management of Companies & Support Services": [7, -1, 3, -3, -3, -3, -6, -6, 1, -2, 2, -1, 7],
            "Mining": [-3, 0, 12, 9, 0, 9, 7, 9, 6, 9, 11, 0, -4],
            "Real Estate, Rental & Leasing": [-2, -6, -2, 8, 10, 8, 4, 4, 5, 6, -2, -4, -2],
            "Construction": [2, 0, 4, 6, 1, -1, -3, 3, -6, 3, 4, 0, 2]
        };

        const headerRow = document.getElementById('headerRow');
        const tableBody = document.getElementById('tableBody');

        // Populate Headers
        months.forEach(month => {
            const th = document.createElement('th');
            th.textContent = month;
            headerRow.appendChild(th);
        });

        function getColor(score) {
            if (score === 0) return '#ffff99';
            if (score > 0) {
                const intensity = Math.min(score / 12, 1);
                return `rgba(46, 204, 113, ${0.2 + (0.8 * intensity)})`;
            }
            if (score < 0) {
                const absScore = Math.abs(score);
                const intensity = Math.min(absScore / 5, 1);
                return `rgba(231, 76, 60, ${0.2 + (0.8 * intensity)})`;
            }
        }

        // Populate Rows
        Object.keys(servicesData).sort().forEach(industry => {
            const tr = document.createElement('tr');

            const nameTd = document.createElement('td');
            nameTd.className = 'industry-col';
            nameTd.textContent = industry;
            tr.appendChild(nameTd);

            servicesData[industry].forEach(score => {
                const td = document.createElement('td');
                // Format: +N, -N, or 0
                td.textContent = score > 0 ? `+${score}` : (score === 0 ? '0' : score);

                // Styling
                if (score === 0) {
                    td.style.backgroundColor = getColor(0); // #ffff99
                    td.style.color = '#333';
                } else {
                    td.style.backgroundColor = getColor(score);
                    if (Math.abs(score) > 8) td.style.color = 'white';
                }

                tr.appendChild(td);
            });
            tableBody.appendChild(tr);
        });



    </script>
    <script>
        // --- New Orders Rank Data ---
        const ranklists = {
            "Nov 2024": {
                growth: ["Arts, Entertainment & Recreation", "Accommodation & Food Services", "Management of Companies & Support Services", "Public Administration", "Information", "Wholesale Trade", "Retail Trade", "Agriculture, Forestry, Fishing & Hunting", "Health Care & Social Assistance", "Professional, Scientific & Technical Services", "Finance & Insurance", "Transportation & Warehousing", "Utilities"],
                decline: ["Mining", "Real Estate, Rental & Leasing", "Educational Services"]
            },
            "Dec 2024": {
                growth: ["Arts, Entertainment & Recreation", "Finance & Insurance", "Transportation & Warehousing", "Retail Trade", "Public Administration", "Health Care & Social Assistance", "Utilities"],
                decline: ["Real Estate, Rental & Leasing", "Educational Services", "Construction", "Information", "Professional, Scientific & Technical Services"]
            },
            "Jan 2025": {
                growth: ["Accommodation & Food Services", "Agriculture, Forestry, Fishing & Hunting", "Educational Services", "Finance & Insurance", "Wholesale Trade", "Transportation & Warehousing", "Health Care & Social Assistance", "Public Administration", "Construction", "Retail Trade"],
                decline: ["Real Estate, Rental & Leasing", "Other Services", "Professional, Scientific & Technical Services", "Information", "Management of Companies & Support Services"]
            },
            "Feb 2025": {
                growth: ["Mining", "Construction", "Finance & Insurance", "Agriculture, Forestry, Fishing & Hunting", "Other Services", "Health Care & Social Assistance", "Wholesale Trade", "Utilities", "Public Administration", "Transportation & Warehousing", "Professional, Scientific & Technical Services"],
                decline: ["Management of Companies & Support Services", "Accommodation & Food Services", "Retail Trade", "Educational Services"]
            },
            "Mar 2025": {
                growth: ["Transportation & Warehousing", "Wholesale Trade", "Utilities", "Accommodation & Food Services", "Finance & Insurance", "Public Administration", "Retail Trade", "Information", "Health Care & Social Assistance"],
                decline: ["Professional, Scientific & Technical Services", "Real Estate, Rental & Leasing", "Management of Companies & Support Services", "Educational Services"]
            },
            "Apr 2025": {
                growth: ["Accommodation & Food Services", "Wholesale Trade", "Transportation & Warehousing", "Educational Services", "Real Estate, Rental & Leasing", "Information", "Retail Trade", "Health Care & Social Assistance"],
                decline: ["Professional, Scientific & Technical Services", "Management of Companies & Support Services", "Construction", "Finance & Insurance", "Public Administration"]
            },
            "May 2025": {
                growth: ["Accommodation & Food Services", "Arts, Entertainment & Recreation", "Public Administration", "Educational Services", "Utilities", "Information"],
                decline: ["Mining", "Management of Companies & Support Services", "Real Estate, Rental & Leasing", "Other Services", "Wholesale Trade", "Retail Trade", "Construction"]
            },
            "Jun 2025": {
                growth: ["Other Services", "Finance & Insurance", "Professional, Scientific & Technical Services", "Transportation & Warehousing", "Wholesale Trade", "Utilities", "Public Administration", "Educational Services"],
                decline: ["Agriculture, Forestry, Fishing & Hunting", "Mining", "Real Estate, Rental & Leasing", "Construction"]
            },
            "Jul 2025": {
                growth: ["Wholesale Trade", "Transportation & Warehousing", "Finance & Insurance", "Public Administration", "Other Services", "Management of Companies & Support Services", "Utilities"],
                decline: ["Accommodation & Food Services", "Construction", "Arts, Entertainment & Recreation", "Agriculture, Forestry, Fishing & Hunting", "Educational Services", "Real Estate, Rental & Leasing", "Health Care & Social Assistance"]
            },
            "Aug 2025": {
                growth: ["Wholesale Trade", "Educational Services", "Arts, Entertainment & Recreation", "Information", "Transportation & Warehousing", "Retail Trade", "Utilities", "Management of Companies & Support Services", "Health Care & Social Assistance", "Finance & Insurance", "Public Administration", "Professional, Scientific & Technical Services", "Real Estate, Rental & Leasing"],
                decline: ["Construction", "Accommodation & Food Services"]
            },
            "Sep 2025": {
                growth: ["Accommodation & Food Services", "Other Services", "Health Care & Social Assistance", "Public Administration", "Information", "Wholesale Trade", "Educational Services", "Finance & Insurance", "Utilities"],
                decline: ["Real Estate, Rental & Leasing", "Construction", "Agriculture, Forestry, Fishing & Hunting", "Retail Trade", "Management of Companies & Support Services", "Professional, Scientific & Technical Services"]
            },
            "Oct 2025": {
                growth: ["Accommodation & Food Services", "Retail Trade", "Wholesale Trade", "Real Estate, Rental & Leasing", "Health Care & Social Assistance", "Utilities", "Transportation & Warehousing", "Agriculture, Forestry, Fishing & Hunting", "Information", "Professional, Scientific & Technical Services", "Educational Services"],
                decline: ["Arts, Entertainment & Recreation", "Management of Companies & Support Services", "Finance & Insurance", "Public Administration", "Construction", "Other Services"]
            },
            "Nov 2025": {
                growth: ["Public Administration", "Arts, Entertainment & Recreation", "Retail Trade", "Other Services", "Wholesale Trade", "Health Care & Social Assistance", "Educational Services", "Transportation & Warehousing", "Finance & Insurance", "Professional, Scientific & Technical Services", "Utilities", "Information"],
                decline: ["Real Estate, Rental & Leasing", "Management of Companies & Support Services", "Construction", "Accommodation & Food Services"]
            }
        };

        // Normalize Name Function (Map variations to standard keys if needed)
        function normalizeName(name) {
            const map = {
                "Nonmetallic Minerals": "Nonmetallic Mineral Products",
                "Power & Energy": "Utilities"
            };
            return map[name] || name;
        }

        // Build Rank Data Table
        const rankTableBody = document.getElementById('rankTableBody');
        const rankHeaderRow = document.getElementById('rankHeaderRow');

        // 1. Populate Headers (Months) - reusing `months` array logic
        // We currently only have 3 months of data for this table.
        // Let's filter `months` to only show those we have data for, OR show all with placeholders.
        // For consistency with heatmap, let's show all but leave empty for missing data.

        months.forEach(month => {
            const th = document.createElement('th');
            th.textContent = month;
            rankHeaderRow.appendChild(th);
        });

        // 2. Iterate Industries and Months to Calculate Scores
        const industries = Object.keys(servicesData).sort();

        industries.forEach(industry => {
            const tr = document.createElement('tr');

            // Industry Name
            const nameTd = document.createElement('td');
            nameTd.className = 'industry-col';
            nameTd.textContent = industry;
            tr.appendChild(nameTd);

            // Loop through months
            months.forEach(month => {
                const list = ranklists[month];
                let score = 0;

                if (list) {
                    // Check Growth
                    const growthIdx = list.growth.findIndex(n => normalizeName(n) === industry);
                    if (growthIdx !== -1) {
                        score = list.growth.length - growthIdx;
                    }

                    // Check Decline
                    if (score === 0) { // Only check decline if not in growth
                        const declineIdx = list.decline.findIndex(n => normalizeName(n) === industry);
                        if (declineIdx !== -1) {
                            score = -(list.decline.length - declineIdx);
                        }
                    }
                }

                const td = document.createElement('td');
                // Only show number if score is non-zero (i.e., we have data)
                // For missing months, show '-'
                if (!list) {
                    td.textContent = '-';
                    td.style.backgroundColor = 'white';
                } else {
                    td.textContent = score > 0 ? `+${score}` : (score === 0 ? '0' : score);
                    td.style.backgroundColor = getColor(score); // Reusing heatmap color scale
                    if (Math.abs(score) > 8) td.style.color = 'white';
                    // Dim zeros if present (meaning 'No Change' or omitted)
                    if (score === 0) {
                        td.style.backgroundColor = getColor(0); // #ffff99
                        td.style.color = '#333';
                        td.textContent = '0';
                    }
                }

                tr.appendChild(td);
            });
            rankTableBody.appendChild(tr);
        });
    </script>

    <!-- ISM Services Survey Results at a Glance -->
    <h2 style="margin-top: 60px;">ISM® Services Survey Results at a Glance</h2>

    <div class="table-container">
        <table id="servicesPmiTable">
            <thead>
                <tr id="servicesPmiHeaderRow">
                    <th class="industry-col">Metric</th>
                    <!-- Months will be populated by JS -->
                </tr>
            </thead>
            <tbody id="servicesPmiBody"></tbody>
        </table>
    </div>

    <div class="footer">
        <p>Source: Institute for Supply Management (ISM) - Services Report on Business</p>
        <p>Last Updated: <span id="last-updated-date">Dec 22, 2025</span></p>
    </div>

    <script>
        // ISM Services PMI Data (Pivoted)
        // Data from ISM Services Reports (Nov 2024 - Nov 2025)
        const rawServicesPmiData = [
            { date: "Nov 2025", servicesPmi: 52.6, businessActivity: 54.5, newOrders: 52.9, employment: 48.9, supplierDeliveries: 54.1, inventories: 53.4, prices: 65.4, backlogOrders: 49.1, newExportOrders: 48.7, imports: 48.9, inventorySentiment: 54.8 },
            { date: "Oct 2025", servicesPmi: 52.4, businessActivity: 54.3, newOrders: 56.2, employment: 48.2, supplierDeliveries: 50.8, inventories: 49.5, prices: 70.0, backlogOrders: 40.8, newExportOrders: 47.8, imports: 43.7, inventorySentiment: 55.5 },
            { date: "Sep 2025", servicesPmi: 50.0, businessActivity: 49.9, newOrders: 51.9, employment: 48.1, supplierDeliveries: 52.1, inventories: 51.6, prices: 64.0, backlogOrders: 45.3, newExportOrders: 49.5, imports: 50.2, inventorySentiment: 56.2 },
            { date: "Aug 2025", servicesPmi: 52.0, businessActivity: 55.0, newOrders: 53.0, employment: 50.2, supplierDeliveries: 52.4, inventories: 52.1, prices: 67.8, backlogOrders: 46.8, newExportOrders: 50.1, imports: 51.3, inventorySentiment: 55.8 },
            { date: "Jul 2025", servicesPmi: 50.1, businessActivity: 49.8, newOrders: 52.4, employment: 46.4, supplierDeliveries: 52.0, inventories: 50.3, prices: 64.1, backlogOrders: 44.2, newExportOrders: 48.9, imports: 49.7, inventorySentiment: 56.5 },
            { date: "Jun 2025", servicesPmi: 50.8, businessActivity: 52.5, newOrders: 54.1, employment: 47.3, supplierDeliveries: 51.9, inventories: 51.2, prices: 66.2, backlogOrders: 45.7, newExportOrders: 49.2, imports: 50.5, inventorySentiment: 57.1 },
            { date: "May 2025", servicesPmi: 49.9, businessActivity: 50.2, newOrders: 50.9, employment: 50.7, supplierDeliveries: 51.3, inventories: 49.8, prices: 63.5, backlogOrders: 43.9, newExportOrders: 48.5, imports: 49.1, inventorySentiment: 56.8 },
            { date: "Apr 2025", servicesPmi: 51.6, businessActivity: 52.9, newOrders: 54.0, employment: 49.3, supplierDeliveries: 52.6, inventories: 50.7, prices: 65.1, backlogOrders: 46.1, newExportOrders: 49.8, imports: 50.3, inventorySentiment: 57.3 },
            { date: "Mar 2025", servicesPmi: 50.8, businessActivity: 51.4, newOrders: 52.2, employment: 48.5, supplierDeliveries: 51.7, inventories: 50.1, prices: 64.3, backlogOrders: 44.8, newExportOrders: 48.7, imports: 49.6, inventorySentiment: 56.9 },
            { date: "Feb 2025", servicesPmi: 53.5, businessActivity: 56.3, newOrders: 57.0, employment: 52.1, supplierDeliveries: 53.2, inventories: 52.8, prices: 68.4, backlogOrders: 48.5, newExportOrders: 51.2, imports: 52.1, inventorySentiment: 58.2 },
            { date: "Jan 2025", servicesPmi: 52.8, businessActivity: 54.7, newOrders: 55.3, employment: 50.4, supplierDeliveries: 52.5, inventories: 51.9, prices: 66.7, backlogOrders: 47.2, newExportOrders: 50.3, imports: 51.4, inventorySentiment: 57.6 },
            { date: "Dec 2024", servicesPmi: 54.0, businessActivity: 58.2, newOrders: 58.5, employment: 51.8, supplierDeliveries: 53.8, inventories: 53.2, prices: 70.8, backlogOrders: 49.6, newExportOrders: 51.8, imports: 52.7, inventorySentiment: 58.9 },
            { date: "Nov 2024", servicesPmi: 52.1, businessActivity: 53.7, newOrders: 53.7, employment: 51.5, supplierDeliveries: 52.1, inventories: 51.3, prices: 58.2, backlogOrders: 46.3, newExportOrders: 49.7, imports: 50.8, inventorySentiment: 57.2 }
        ];

        // Reverse to get chronological order (Nov 2024 -> Nov 2025)
        const servicesPmiData = rawServicesPmiData.reverse();

        // Extract dates for headers
        const servicesPmiDates = servicesPmiData.map(d => d.date);

        // Populate Headers
        const servicesPmiHeaderRow = document.getElementById('servicesPmiHeaderRow');
        servicesPmiDates.forEach(date => {
            const th = document.createElement('th');
            th.textContent = date;
            servicesPmiHeaderRow.appendChild(th);
        });

        // Define metrics to display
        const servicesPmiMetrics = [
            { key: 'servicesPmi', label: 'Services PMI®' },
            { key: 'businessActivity', label: 'Business Activity/Production' },
            { key: 'newOrders', label: 'New Orders' },
            { key: 'employment', label: 'Employment' },
            { key: 'supplierDeliveries', label: 'Supplier Deliveries' },
            { key: 'inventories', label: 'Inventories' },
            { key: 'prices', label: 'Prices' },
            { key: 'backlogOrders', label: 'Backlog of Orders' },
            { key: 'newExportOrders', label: 'New Export Orders' },
            { key: 'imports', label: 'Imports' },
            { key: 'inventorySentiment', label: 'Inventory Sentiment' }
        ];

        // Populate Rows
        const servicesPmiBody = document.getElementById('servicesPmiBody');
        servicesPmiMetrics.forEach(metric => {
            const tr = document.createElement('tr');

            // Metric Name
            const nameTd = document.createElement('td');
            nameTd.className = 'industry-col';
            nameTd.textContent = metric.label;
            tr.appendChild(nameTd);

            // Values for each month
            servicesPmiData.forEach(monthData => {
                const td = document.createElement('td');
                const value = monthData[metric.key];
                td.textContent = value !== null && value !== undefined ? value.toFixed(1) : '-';

                // Color coding based on 50 threshold
                if (value !== null && value !== undefined) {
                    if (metric.key === 'prices' || metric.key === 'supplierDeliveries' || metric.key === 'inventorySentiment') {
                        // These metrics don't follow the 50 rule in the same way
                        td.style.backgroundColor = '#f8f9fa';
                    } else if (value >= 50) {
                        // Expansion
                        const intensity = Math.min((value - 50) / 10, 1);
                        td.style.backgroundColor = `rgba(46, 204, 113, ${0.2 + (0.6 * intensity)})`;
                    } else {
                        // Contraction
                        const intensity = Math.min((50 - value) / 10, 1);
                        td.style.backgroundColor = `rgba(231, 76, 60, ${0.2 + (0.6 * intensity)})`;
                    }
                }

                tr.appendChild(td);
            });
            servicesPmiBody.appendChild(tr);
        });
    </script>

    <!-- Key Insights for Services PMI Survey Results -->
    <div id="services-pmi-survey-insights" class="summary-box" style="margin-top: 30px;">
        <span class="summary-title">Key Insights (Nov 2025)</span>
        <p>The Services PMI® registered 52.6% in November, marking continued expansion in the services sector. Business
            Activity remained strong at 54.5%, while Employment contracted slightly at 48.9%. Prices remained elevated
            at 65.4%, indicating persistent cost pressures across the service economy.</p>
    </div>

</body>

</html>