<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ISM Services Industry Heatmap</title>
    <meta name="deployment-version" content="services-init-2025-12-22">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
            background-color: #f8f9fa;
            color: #333;
        }

        h1,
        h2 {
            color: #2c3e50;
            text-align: center;
        }

        h2 {
            margin-top: 60px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            display: inline-block;
        }

        table {
            border-collapse: separate;
            border-spacing: 0;
            width: 100%;
            margin: 20px auto;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            background-color: white;
            font-size: 0.9em;
            border-radius: 8px;
        }

        th,
        td {
            padding: 12px 15px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }

        th {
            background-color: #e67e22;
            /* Orange for Services */
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 20;
            box-shadow: 0 2px 2px -1px rgba(0, 0, 0, 0.2);
            border-bottom: none;
        }

        .industry-col {
            text-align: left;
            font-weight: 600;
            width: 260px;
            position: sticky;
            left: 0;
            z-index: 15;
            border-right: 1px solid #ddd;
            background-color: #fff;
        }

        th.industry-col {
            z-index: 30;
            background-color: #d35400;
            /* Darker orange */
            border-right: 1px solid #a04000;
        }

        /* Zebra Stripping */
        tbody tr:nth-child(even) .industry-col {
            background-color: #f9f9f9;
        }

        tbody tr:hover .industry-col {
            background-color: #e2e6ea !important;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin: 30px auto;
            font-size: 0.9em;
            background: white;
            padding: 15px;
            border-radius: 50px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            width: fit-content;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
        }

        .color-box {
            width: 18px;
            height: 18px;
            border-radius: 4px;
            border: none;
        }

        .back-nav {
            margin-bottom: 20px;
        }

        .back-nav a {
            text-decoration: none;
            color: #64748b;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            font-family: 'Segoe UI', sans-serif;
            font-size: 0.95rem;
            transition: color 0.2s ease;
        }

        .back-nav a:hover {
            color: #1e293b;
            text-decoration: underline;
        }

        .summary-box {
            background-color: #fff;
            border-left: 5px solid #e67e22;
            padding: 20px;
            margin: 15px auto 50px auto;
            max-width: 95%;
            border-radius: 0 4px 4px 0;
            color: #444;
            line-height: 1.6;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body>

    <div class="back-nav">
        <a href="index.html">‚Üê Back to Financial Dashboard</a>
    </div>

    <h1>ISM Services Industry Trends (Nov '24 - Nov '25)</h1>

    <div class="legend">
        <div class="legend-item">
            <div class="color-box" style="background-color: #2ecc71;"></div> Strong Growth
        </div>
        <div class="legend-item">
            <div class="color-box" style="background-color: #ffff99;"></div> Stable (0)
        </div>
        <div class="legend-item">
            <div class="color-box" style="background-color: #e74c3c;"></div> Strong Contraction
        </div>
    </div>

    <table id="heatmapTable">
        <thead>
            <tr id="headerRow">
                <th class="industry-col">Industry</th>
                <!-- Months will be populated by JS -->
            </tr>
        </thead>
        <tbody id="tableBody">
            <!-- Data rows will be populated by JS -->
        </tbody>
    </table>

    <div class="summary-box">
        <span class="summary-title"
            style="text-transform: uppercase; font-size: 0.8em; letter-spacing: 0.5px; color: #d35400;">Key
            Insights</span><br>
        The <strong>Services PMI</strong> expanded for the ninth time in 2025 (52.6%). <strong>Business
            Activity</strong> and <strong>New Orders</strong> remain robust, driving growth. However,
        <strong>Employment</strong> contracted for the sixth consecutive month (48.9%), indicating labor market softness
        despite strong demand. <strong>Prices</strong> remain elevated (65.4%), although this is the lowest reading
        since April.
    </div>

    <h2>Services PMI Overview (Nov 2025)</h2>
    <table id="pmiTable" style="max-width: 800px;">
        <thead>
            <tr>
                <th style="text-align: left;">Metric</th>
                <th>Index Value</th>
                <th>Trend</th>
            </tr>
        </thead>
        <tbody id="pmiBody"></tbody>
    </table>

    <div class="summary-box">
        <strong>Note:</strong> Historical data for Services Industries (Nov 2024 - Oct 2025) is currently being
        aggregated. The table above reflects the most recent report (Nov 2025).
    </div>

    <script>
        const months = [
            "Nov 2024", "Dec 2024", "Jan 2025", "Feb 2025", "Mar 2025",
            "Apr 2025", "May 2025", "Jun 2025", "Jul 2025", "Aug 2025", "Sep 2025", "Oct 2025", "Nov 2025"
        ];

        // Services Industries (18)
        // Data populated for Nov 2025 based on report. Histores set to 0 placeholder.

        // Nov 2025 Rankings:
        // Growth (1-12): 
        // 1. Retail Trade (+12)
        // 2. Arts, Entertainment & Recreation (+11)
        // 3. Accommodation & Food Services (+10)
        // 4. Wholesale Trade (+9)
        // 5. Health Care & Social Assistance (+8)
        // 6. Educational Services (+7)
        // 7. Public Administration (+6)
        // 8. Agriculture, Forestry, Fishing & Hunting (+5)
        // 9. Finance & Insurance (+4)
        // 10. Information (+3)
        // 11. Professional, Scientific & Technical Services (+2)
        // 12. Utilities (+1)

        // Contraction (1-5):
        // 1. Construction (-5)
        // 2. Real Estate, Rental & Leasing (-4)
        // 3. Mining (-3)
        // 4. Management of Companies & Support Services (-2)
        // 5. Transportation & Warehousing (-1)

        // --- ISM Services PMI Data (Nov 2025) ---
        const pmiData = [
            { metric: "Services PMI", value: 52.6, trend: "Expansion" },
            { metric: "Business Activity", value: 54.5, trend: "Expansion" },
            { metric: "New Orders", value: 52.9, trend: "Expansion" },
            { metric: "Employment", value: 48.9, trend: "Contraction" },
            { metric: "Supplier Deliveries", value: 54.1, trend: "Slower" },
            { metric: "Prices", value: 65.4, trend: "Increasing" },
            // Inventories, etc. can be added if available
        ];

        // Stable: Other Services (0)

        const servicesData = {
            "Retail Trade": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12],
            "Arts, Entertainment & Recreation": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11],
            "Accommodation & Food Services": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10],
            "Wholesale Trade": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9],
            "Health Care & Social Assistance": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8],
            "Educational Services": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 7],
            "Public Administration": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6],
            "Agriculture, Forestry, Fishing & Hunting": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5],
            "Finance & Insurance": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4],
            "Information": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3],
            "Professional, Scientific & Technical Services": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2],
            "Utilities": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
            "Other Services": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
            "Transportation & Warehousing": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1],
            "Management of Companies & Support Services": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2],
            "Mining": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -3],
            "Real Estate, Rental & Leasing": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -4],
            "Construction": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -5]
        };

        const headerRow = document.getElementById('headerRow');
        const tableBody = document.getElementById('tableBody');

        // Populate Headers
        months.forEach(month => {
            const th = document.createElement('th');
            th.textContent = month;
            headerRow.appendChild(th);
        });

        function getColor(score) {
            if (score === 0) return '#ffff99';
            if (score > 0) {
                const intensity = Math.min(score / 12, 1);
                return `rgba(46, 204, 113, ${0.2 + (0.8 * intensity)})`;
            }
            if (score < 0) {
                const absScore = Math.abs(score);
                const intensity = Math.min(absScore / 5, 1);
                return `rgba(231, 76, 60, ${0.2 + (0.8 * intensity)})`;
            }
        }

        // Populate Rows
        Object.keys(servicesData).sort().forEach(industry => {
            const tr = document.createElement('tr');

            const nameTd = document.createElement('td');
            nameTd.className = 'industry-col';
            nameTd.textContent = industry;
            tr.appendChild(nameTd);

            servicesData[industry].forEach(score => {
                const td = document.createElement('td');
                // Only show number if not 0 placeholder for now, or just show 0
                // For historical placeholders, maybe show '-'
                if (score === 0 && industry !== 'Other Services') {
                    // To distinguish actual 0 from data missing 0
                    // But here we hardcoded. Let's just show what we have.
                    // For Nov 2025, Other Services is actually 0.
                    // For others, 0 likely means missing data.
                    td.textContent = (score === 0 && months.indexOf("Nov 2025") === 12) ? '0' : '-';
                    // Actually checking index is harder inside loop without index arg
                }

                td.textContent = score > 0 ? `+${score}` : (score === 0 ? '0' : score);

                // Dim missing data
                if (score === 0 && industry !== 'Other Services') {
                    td.style.backgroundColor = '#f4f4f4';
                    td.style.color = '#ccc';
                } else {
                    td.style.backgroundColor = getColor(score);
                    if (Math.abs(score) > 8) td.style.color = 'white';
                }

                tr.appendChild(td);
            });
            tableBody.appendChild(tr);
        });

        // Populate PMI Table
        const pmiBody = document.getElementById('pmiBody');
        pmiData.forEach(item => {
            const tr = document.createElement('tr');

            const nameTd = document.createElement('td');
            nameTd.textContent = item.metric;
            nameTd.style.textAlign = 'left';
            nameTd.style.fontWeight = '600';
            tr.appendChild(nameTd);

            const valTd = document.createElement('td');
            valTd.textContent = item.value + '%';

            // Color coding for Index
            if (item.value > 50) valTd.style.backgroundColor = 'rgba(46, 204, 113, 0.1)';
            else if (item.value < 50) valTd.style.backgroundColor = 'rgba(231, 76, 60, 0.1)';

            tr.appendChild(valTd);

            const trendTd = document.createElement('td');
            trendTd.textContent = item.trend;
            if (item.trend === 'Expansion' || item.trend === 'Increasing') trendTd.style.color = '#27ae60';
            else if (item.trend === 'Contraction' || item.trend === 'Decreasing') trendTd.style.color = '#c0392b';
            trendTd.style.fontWeight = 'bold';
            tr.appendChild(trendTd);

            pmiBody.appendChild(tr);
        });

    </script>
</body>

</html>